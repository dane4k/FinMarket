CREATE TABLE users
(
    tg_id       BIGINT PRIMARY KEY,
    name        TEXT NOT NULL,
    rating      DOUBLE PRECISION DEFAULT 0.0,
    tg_username TEXT NOT NULL,
    avatar_pic  TEXT NOT NULL,
    banned      BOOLEAN          DEFAULT FALSE,
    reg_date    DATE             DEFAULT CURRENT_DATE
);


CREATE TYPE condition AS ENUM (
    'Новый',
    'Как новый',
    'Хороший',
    'Нормальный',
    'Плохой'
);

CREATE TABLE categories
(
    id   SERIAL PRIMARY KEY,
    name TEXT NOT NULL
);

CREATE TABLE subways
(
    id   SERIAL PRIMARY KEY,
    name TEXT NOT NULL
);

CREATE TABLE products
(
    id                SERIAL PRIMARY KEY,
    seller_id         BIGINT    NOT NULL REFERENCES users (tg_id),
    category_id       SMALLINT  NOT NULL REFERENCES categories (id),
    subway_id         SMALLINT  NOT NULL REFERENCES subways (id),
    photos_urls       TEXT[] NOT NULL,
    name              TEXT      NOT NULL,
    description       TEXT      NOT NULL,
    n_views           SMALLINT DEFAULT 0,
    product_condition condition NOT NULL,
    date_posted       DATE     DEFAULT CURRENT_DATE,
    price             INTEGER   NOT NULL,
    active            BOOLEAN  DEFAULT TRUE
);



CREATE TABLE reviews
(
    id        SERIAL PRIMARY KEY,
    user_id   BIGINT   NOT NULL REFERENCES users (tg_id),
    seller_id BIGINT   NOT NULL REFERENCES users (tg_id),
    rating    SMALLINT NOT NULL,
    comment   TEXT,
    date      DATE DEFAULT CURRENT_DATE
);

CREATE TABLE favorites
(
    user_id    BIGINT  NOT NULL REFERENCES users (tg_id),
    product_id INTEGER NOT NULL REFERENCES products (id),
    PRIMARY KEY (user_id, product_id),
    added_at   DATE DEFAULT CURRENT_DATE
);

CREATE TABLE auth_records
(
    id         SERIAL PRIMARY KEY,
    tg_id      BIGINT,
    token      TEXT NOT NULL UNIQUE,
    jwt        TEXT,
    status     TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT NOW(),
    expires_at TIMESTAMP
);

CREATE TABLE invalid_jwts
(
    id        SERIAL PRIMARY KEY,
    jwt_token TEXT NOT NULL
);



INSERT INTO subways (name)
VALUES ('Авиамоторная'),
       ('Автозаводская'),
       ('Академическая'),
       ('Александровский сад'),
       ('Алексеевская'),
       ('Алма-Атинская'),
       ('Алтуфьево'),
       ('Аннино'),
       ('Арбатская'),
       ('Аэропорт'),
       ('Бабушкинская'),
       ('Багратионовская'),
       ('Баррикадная'),
       ('Бауманская'),
       ('Беговая'),
       ('Беломорская'),
       ('Белорусская'),
       ('Беляево'),
       ('Бибирево'),
       ('Библиотека имени Ленина'),
       ('Битцевский парк'),
       ('Борисово'),
       ('Боровицкая'),
       ('Боровское шоссе'),
       ('Ботанический сад'),
       ('Братиславская'),
       ('Бульвар адмирала Ушакова'),
       ('Бульвар Дмитрия Донского'),
       ('Бульвар Рокоссовского'),
       ('Бунинская аллея'),
       ('Варшавская'),
       ('ВДНХ'),
       ('Верхние Лихоборы'),
       ('Владыкино'),
       ('Водный стадион'),
       ('Войковская'),
       ('Волгоградский проспект'),
       ('Волжская'),
       ('Волоколамская'),
       ('Воробьёвы горы'),
       ('Выставочная'),
       ('Выхино'),
       ('Говорово'),
       ('Деловой центр'),
       ('Динамо'),
       ('Дмитровская'),
       ('Добрынинская'),
       ('Домодедовская'),
       ('Достоевская'),
       ('Дубровка'),
       ('Жулебино'),
       ('Зябликово'),
       ('Измайловская'),
       ('Калужская'),
       ('Кантемировская'),
       ('Каховская'),
       ('Каширская'),
       ('Киевская'),
       ('Китай-город'),
       ('Кожуховская'),
       ('Коломенская'),
       ('Коммунарка'),
       ('Комсомольская'),
       ('Коньково'),
       ('Котельники'),
       ('Красногвардейская'),
       ('Краснопресненская'),
       ('Красносельская'),
       ('Красные ворота'),
       ('Крестьянская застава'),
       ('Кропоткинская'),
       ('Крылатское'),
       ('Кузнецкий мост'),
       ('Кузьминки'),
       ('Кунцевская'),
       ('Курская'),
       ('Кутузовская'),
       ('Ленинский проспект'),
       ('Лермонтовский проспект'),
       ('Лесопарковая'),
       ('Лубянка'),
       ('Люблино'),
       ('Марксистская'),
       ('Марьина роща'),
       ('Марьино'),
       ('Маяковская'),
       ('Медведково'),
       ('Международная'),
       ('Менделеевская'),
       ('Митино'),
       ('Молодёжная'),
       ('Нагатинская'),
       ('Нагорная'),
       ('Нахимовский проспект'),
       ('Новогиреево'),
       ('Новокосино'),
       ('Новокузнецкая'),
       ('Новопеределкино'),
       ('Новослободская'),
       ('Новые Черёмушки'),
       ('Октябрьская'),
       ('Октябрьское поле'),
       ('Орехово'),
       ('Отрадное'),
       ('Охотный ряд'),
       ('Павелецкая'),
       ('Парк культуры'),
       ('Парк Победы'),
       ('Партизанская'),
       ('Первомайская'),
       ('Перово'),
       ('Петровско-Разумовская'),
       ('Печатники'),
       ('Пионерская'),
       ('Планерная'),
       ('Площадь Ильича'),
       ('Площадь Революции'),
       ('Полежаевская'),
       ('Полянка'),
       ('Пражская'),
       ('Преображенская площадь'),
       ('Пролетарская'),
       ('Проспект Вернадского'),
       ('Проспект Мира'),
       ('Профсоюзная'),
       ('Пушкинская'),
       ('Пятницкое шоссе'),
       ('Речной вокзал'),
       ('Рижская'),
       ('Римская'),
       ('Рязанский проспект'),
       ('Савёловская'),
       ('Свиблово'),
       ('Севастопольская'),
       ('Селигерская'),
       ('Семеновская'),
       ('Серпуховская'),
       ('Славянский бульвар'),
       ('Смоленская'),
       ('Сокол'),
       ('Сокольники'),
       ('Спартак'),
       ('Спортивная'),
       ('Сретенский бульвар'),
       ('Строгино'),
       ('Студенческая'),
       ('Сухаревская'),
       ('Сходненская'),
       ('Таганская'),
       ('Тверская'),
       ('Театральная'),
       ('Текстильщики'),
       ('Тёплый Стан'),
       ('Тимирязевская'),
       ('Третьяковская'),
       ('Тропарёво'),
       ('Трубная'),
       ('Тульская'),
       ('Тургеневская'),
       ('Тушинская'),
       ('Улица 1905 года'),
       ('Улица Академика Янгеля'),
       ('Улица Горчакова'),
       ('Улица Скобелевская'),
       ('Улица Старокачаловская'),
       ('Университет'),
       ('Филёвский парк'),
       ('Фили'),
       ('Фрунзенская'),
       ('Царицыно'),
       ('Цветной бульвар'),
       ('Черкизовская'),
       ('Чертановская'),
       ('Чеховская'),
       ('Чистые пруды'),
       ('Чкаловская'),
       ('Шаболовская'),
       ('Шипиловская'),
       ('Шоссе Энтузиастов'),
       ('Щёлковская'),
       ('Щукинская'),
       ('Электрозаводская'),
       ('Юго-Западная'),
       ('Южная'),
       ('Ясенево');


